
R version 2.14.0 (2011-10-31)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library(splicing)
> 
> gene <- createGene(list(c(1,20), c(31,40)),
+                    list(c(1), c(1,2)))
> 
> exons <- .Call("R_splicing_gff_exon_start_end", gene, 1L, PACKAGE="splicing")
> 
> .Call("R_splicing_numeric_cigar", exons, noIso(gene), 1L)
[1]   0  20   0  20 -10  10   0
> 
> exons$start <- exons$start - 1L
> exons$end   <- exons$end   - 1L
> 
> .Call("R_splicing_numeric_cigar", exons, noIso(gene), 0L)
[1]   0  20   0  20 -10  10   0
> 
> options(width=60)
> 
> cigar <- c('4I29M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '32M277N1M', '31M277N2M', '30M277N3M', '29M277N4M',
+            '28M277N5M', '26M277N7M', '24M277N9M', '23M277N10M',
+            '21M277N12M', '19M277N14M', '18M277N15M', '17M277N16M',
+            '16M277N17M', '15M277N18M', '14M277N19M', '13M277N20M',
+            '12M277N21M', '11M277N22M', '10M277N23M', '9M277N24M',
+            '8M277N25M', '7M277N25M831N1M', '7M277N25M1403N1M',
+            '6M277N25M1403N2M', '5M277N25M1403N3M', '4M277N25M1403N4M',
+            '4M277N25M1403N4M', '3M277N25M1403N5M', '3M277N25M1403N5M',
+            '2M277N25M1403N6M', '2M277N25M1403N6M', '1M277N25M1403N7M',
+            '1M277N25M1403N7M', '25M1403N8M', '24M1403N9M',
+            '24M1403N9M', '23M1403N10M', '23M1403N10M', '22M1403N11M',
+            '22M1403N11M', '21M1403N12M', '21M1403N12M', '20M1403N13M',
+            '20M1403N13M', '19M1403N14M', '19M1403N14M', '18M1403N15M',
+            '18M1403N15M', '17M1403N16M', '16M1403N17M', '16M1403N17M',
+            '15M1403N18M', '15M1403N18M', '14M1403N19M', '14M1403N19M',
+            '13M1403N20M', '13M1403N20M', '12M1403N21M', '12M1403N21M',
+            '11M1403N22M', '11M1403N22M', '10M1403N23M', '9M1403N24M',
+            '9M1403N24M', '8M1403N25M', '8M1403N25M', '8M1403N25M',
+            '7M1403N26M', '7M1403N26M', '6M1403N27M', '6M1403N27M',
+            '5M1403N28M', '5M1403N28M', '4M1403N29M', '4M1403N29M',
+            '3M831N30M', '3M1403N30M', '3M1403N30M', '2M1403N31M',
+            '1M1403N32M', '1M1403N32M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '33M', '33M', '33M', '33M', '33M', '33M', '33M',
+            '32M4008N1M', '32M5482N1M', '32M4008N1M', '32M5482N1M',
+            '31M4008N2M', '31M5482N2M', '31M4008N2M', '31M5482N2M',
+            '30M4008N3M', '30M5482N3M', '30M4008N3M', '30M5482N3M',
+            '29M4008N4M', '29M4008N4M', '28M4008N5M', '28M4008N5M',
+            '27M4008N6M', '27M4008N6M', '26M4008N7M', '25M4008N8M',
+            '25M4008N8M', '25M5482N8M', '24M4008N9M', '24M4008N9M',
+            '24M5482N9M', '23M4008N10M', '23M5482N10M', '22M4008N11M',
+            '22M5482N11M', '22M4008N11M', '21M4008N12M', '21M4008N12M',
+            '21M5482N12M', '20M4008N13M', '20M4008N13M', '19M4008N14M',
+            '19M4008N14M', '18M4008N15M', '17M4008N16M', '17M4008N16M',
+            '16M4008N17M', '16M4008N17M', '15M4008N18M', '15M5482N18M',
+            '15M4008N18M', '14M4008N19M', '13M4008N20M', '13M4008N20M',
+            '12M4008N21M', '12M4008N21M', '10M4008N23M', '8M4008N25M',
+            '6M4008N27M', '5M5482N28M', '4M4008N29M', '3M4008N30M',
+            '2M4008N31M', '1M5482N32M', '1M5482N32M', '1M4008N32M')
> 
> cig <- .Call("R_splicing_parse_cigar", cigar, 33L,
+              PACKAGE="splicing")
> cig
$cigar
  [1]    29    33    33    33    33    33    33    33    32
 [10]  -277     1    31  -277     2    30  -277     3    29
 [19]  -277     4    28  -277     5    26  -277     7    24
 [28]  -277     9    23  -277    10    21  -277    12    19
 [37]  -277    14    18  -277    15    17  -277    16    16
 [46]  -277    17    15  -277    18    14  -277    19    13
 [55]  -277    20    12  -277    21    11  -277    22    10
 [64]  -277    23     9  -277    24     8  -277    25     7
 [73]  -277    25  -831     1     7  -277    25 -1403     1
 [82]     6  -277    25 -1403     2     5  -277    25 -1403
 [91]     3     4  -277    25 -1403     4     4  -277    25
[100] -1403     4     3  -277    25 -1403     5     3  -277
[109]    25 -1403     5     2  -277    25 -1403     6     2
[118]  -277    25 -1403     6     1  -277    25 -1403     7
[127]     1  -277    25 -1403     7    25 -1403     8    24
[136] -1403     9    24 -1403     9    23 -1403    10    23
[145] -1403    10    22 -1403    11    22 -1403    11    21
[154] -1403    12    21 -1403    12    20 -1403    13    20
[163] -1403    13    19 -1403    14    19 -1403    14    18
[172] -1403    15    18 -1403    15    17 -1403    16    16
[181] -1403    17    16 -1403    17    15 -1403    18    15
[190] -1403    18    14 -1403    19    14 -1403    19    13
[199] -1403    20    13 -1403    20    12 -1403    21    12
[208] -1403    21    11 -1403    22    11 -1403    22    10
[217] -1403    23     9 -1403    24     9 -1403    24     8
[226] -1403    25     8 -1403    25     8 -1403    25     7
[235] -1403    26     7 -1403    26     6 -1403    27     6
[244] -1403    27     5 -1403    28     5 -1403    28     4
[253] -1403    29     4 -1403    29     3  -831    30     3
[262] -1403    30     3 -1403    30     2 -1403    31     1
[271] -1403    32     1 -1403    32    33    33    33    33
[280]    33    33    33    33    33    33    33    33    33
[289]    33    33    33    33    33    33    33    33    33
[298]    33    33    33    33    33    33    33    33    33
[307]    33    33    33    33    33    33    33    33    33
[316]    33    33    33    33    33    33    33    33    33
[325]    33    33    33    33    33    33    33    33    33
[334]    33    32 -4008     1    32 -5482     1    32 -4008
[343]     1    32 -5482     1    31 -4008     2    31 -5482
[352]     2    31 -4008     2    31 -5482     2    30 -4008
[361]     3    30 -5482     3    30 -4008     3    30 -5482
[370]     3    29 -4008     4    29 -4008     4    28 -4008
[379]     5    28 -4008     5    27 -4008     6    27 -4008
[388]     6    26 -4008     7    25 -4008     8    25 -4008
[397]     8    25 -5482     8    24 -4008     9    24 -4008
[406]     9    24 -5482     9    23 -4008    10    23 -5482
[415]    10    22 -4008    11    22 -5482    11    22 -4008
[424]    11    21 -4008    12    21 -4008    12    21 -5482
[433]    12    20 -4008    13    20 -4008    13    19 -4008
[442]    14    19 -4008    14    18 -4008    15    17 -4008
[451]    16    17 -4008    16    16 -4008    17    16 -4008
[460]    17    15 -4008    18    15 -5482    18    15 -4008
[469]    18    14 -4008    19    13 -4008    20    13 -4008
[478]    20    12 -4008    21    12 -4008    21    10 -4008
[487]    23     8 -4008    25     6 -4008    27     5 -5482
[496]    28     4 -4008    29     3 -4008    30     2 -4008
[505]    31     1 -5482    32     1 -5482    32     1 -4008
[514]    32

$cigaridx
  [1]   0   1   2   3   4   5   6   7   8  11  14  17  20
 [14]  23  26  29  32  35  38  41  44  47  50  53  56  59
 [27]  62  65  68  71  76  81  86  91  96 101 106 111 116
 [40] 121 126 131 134 137 140 143 146 149 152 155 158 161
 [53] 164 167 170 173 176 179 182 185 188 191 194 197 200
 [66] 203 206 209 212 215 218 221 224 227 230 233 236 239
 [79] 242 245 248 251 254 257 260 263 266 269 272 275 276
 [92] 277 278 279 280 281 282 283 284 285 286 287 288 289
[105] 290 291 292 293 294 295 296 297 298 299 300 301 302
[118] 303 304 305 306 307 308 309 310 311 312 313 314 315
[131] 316 317 318 319 320 321 322 323 324 325 326 327 328
[144] 329 330 331 332 333 334 337 340 343 346 349 352 355
[157] 358 361 364 367 370 373 376 379 382 385 388 391 394
[170] 397 400 403 406 409 412 415 418 421 424 427 430 433
[183] 436 439 442 445 448 451 454 457 460 463 466 469 472
[196] 475 478 481 484 487 490 493 496 499 502 505 508 511
[209] 514

$cigarlength
  [1] 29 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
 [19] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
 [37] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
 [55] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
 [73] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
 [91] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[109] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[127] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[145] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[163] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[181] 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33
[199] 33 33 33 33 33 33 33 33 33 33

> 
> 
