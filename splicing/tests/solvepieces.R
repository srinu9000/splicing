
library(splicing)

gene <- createGene(list(c(1,20), c(31,40)),
                   list(c(1), c(1,2)))

exons <- .Call("R_splicing_gff_exon_start_end", gene, 1L, PACKAGE="splicing")

.Call("R_splicing_numeric_cigar", exons, noIso(gene), 1L)

exons$start <- exons$start - 1L
exons$end   <- exons$end   - 1L

.Call("R_splicing_numeric_cigar", exons, noIso(gene), 0L)

options(width=60)

cigar <- c('4I29M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '32M277N1M', '31M277N2M', '30M277N3M', '29M277N4M',
           '28M277N5M', '26M277N7M', '24M277N9M', '23M277N10M',
           '21M277N12M', '19M277N14M', '18M277N15M', '17M277N16M',
           '16M277N17M', '15M277N18M', '14M277N19M', '13M277N20M',
           '12M277N21M', '11M277N22M', '10M277N23M', '9M277N24M',
           '8M277N25M', '7M277N25M831N1M', '7M277N25M1403N1M',
           '6M277N25M1403N2M', '5M277N25M1403N3M', '4M277N25M1403N4M',
           '4M277N25M1403N4M', '3M277N25M1403N5M', '3M277N25M1403N5M',
           '2M277N25M1403N6M', '2M277N25M1403N6M', '1M277N25M1403N7M',
           '1M277N25M1403N7M', '25M1403N8M', '24M1403N9M',
           '24M1403N9M', '23M1403N10M', '23M1403N10M', '22M1403N11M',
           '22M1403N11M', '21M1403N12M', '21M1403N12M', '20M1403N13M',
           '20M1403N13M', '19M1403N14M', '19M1403N14M', '18M1403N15M',
           '18M1403N15M', '17M1403N16M', '16M1403N17M', '16M1403N17M',
           '15M1403N18M', '15M1403N18M', '14M1403N19M', '14M1403N19M',
           '13M1403N20M', '13M1403N20M', '12M1403N21M', '12M1403N21M',
           '11M1403N22M', '11M1403N22M', '10M1403N23M', '9M1403N24M',
           '9M1403N24M', '8M1403N25M', '8M1403N25M', '8M1403N25M',
           '7M1403N26M', '7M1403N26M', '6M1403N27M', '6M1403N27M',
           '5M1403N28M', '5M1403N28M', '4M1403N29M', '4M1403N29M',
           '3M831N30M', '3M1403N30M', '3M1403N30M', '2M1403N31M',
           '1M1403N32M', '1M1403N32M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '33M', '33M', '33M', '33M', '33M', '33M', '33M',
           '32M4008N1M', '32M5482N1M', '32M4008N1M', '32M5482N1M',
           '31M4008N2M', '31M5482N2M', '31M4008N2M', '31M5482N2M',
           '30M4008N3M', '30M5482N3M', '30M4008N3M', '30M5482N3M',
           '29M4008N4M', '29M4008N4M', '28M4008N5M', '28M4008N5M',
           '27M4008N6M', '27M4008N6M', '26M4008N7M', '25M4008N8M',
           '25M4008N8M', '25M5482N8M', '24M4008N9M', '24M4008N9M',
           '24M5482N9M', '23M4008N10M', '23M5482N10M', '22M4008N11M',
           '22M5482N11M', '22M4008N11M', '21M4008N12M', '21M4008N12M',
           '21M5482N12M', '20M4008N13M', '20M4008N13M', '19M4008N14M',
           '19M4008N14M', '18M4008N15M', '17M4008N16M', '17M4008N16M',
           '16M4008N17M', '16M4008N17M', '15M4008N18M', '15M5482N18M',
           '15M4008N18M', '14M4008N19M', '13M4008N20M', '13M4008N20M',
           '12M4008N21M', '12M4008N21M', '10M4008N23M', '8M4008N25M',
           '6M4008N27M', '5M5482N28M', '4M4008N29M', '3M4008N30M',
           '2M4008N31M', '1M5482N32M', '1M5482N32M', '1M4008N32M')

cig <- .Call("R_splicing_parse_cigar", cigar, 33L,
             PACKAGE="splicing")
cig

