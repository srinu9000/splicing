
R version 2.13.0 (2011-04-13)
Copyright (C) 2011 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library(splicing)
> 
> options(width=60)
> 
> fileDir <- system.file("test_files", package="splicing")
> 
> checkorder <- function(x) {
+   x <- matrix(x, nc=2, byrow=TRUE)
+   ! is.unsorted(pmin(x[,1], x[,2]))
+ }
> 
> f1 <- readSAM(sprintf("%s/%s", fileDir, "single.sam"))
> f2 <- readSAM(sprintf("%s/%s", fileDir, "paired.sam"))
> f2$position
  [1]   1 242   4 278   6 236   7 259   8 271  10 241  11
 [14] 225  11 250  12 217  12 243  12 259  13 242  13 277
 [27]  14 248  14 267  16 234  16 267  17 283  17 300  19
 [40] 220  19 250  19 288  20 252  20 261  22 225  22 240
 [53]  25 259  26 243  26 253  27 281  28 258  30 277  31
 [66] 259  31 260  31 297  32 263  32 268  33 234  33 261
 [79]  33 266  34 267  35 231  35 262  36 269  36 274  36
 [92] 281  39 285  41 256  41 328  44 273  44 298  44 309
[105]  45 277  45 308  46 281  46 295  47 251  47 259  49
[118] 297  50 281  53 313  54 281  55 270  55 295  55 320
[131]  56 277  56 286  56 299  59 296  60 288  61 284  61
[144] 307  61 337  62 274  63 276  63 307  64 251  64 306
[157]  65 308  66 306  67 281  67 289  67 294  67 305  67
[170] 309  68 304  70 276  71 288  71 327  73 314  74 286
[183]  76 309  77 304  77 316  77 324  78 300  79 324  80
[196] 325  81 315  81 319  81 320  82 295  82 354  83 290
[209]  83 343  84 286  85 294  85 332  86 290  86 334  87
[222] 310  90 329  91 331  91 352  92 336  93 312  93 325
[235]  94 314  95 299  96 311  97 295  97 310  97 317  97
[248] 329  97 349  98 312  98 338  99 331 101 316 101 334
[261] 101 379 102 320 102 320 103 318 103 332 104 318 104
[274] 343 104 353 104 364 105 352 106 322 107 328 110 338
[287] 110 360 111 342 112 326 112 357 112 357 116 340 116
[300] 342 118 360 119 330 120 364 120 370 121 341 121 371
[313] 122 330 122 353 122 357 124 338 125 339 125 367 126
[326] 319 126 373 127 373 128 386 129 365 129 365 130 365
[339] 131 374 132 368 133 334 133 376 134 370 135 503 136
[352] 346 136 355 137 394 138 393 139 375 139 390 140 373
[365] 140 392 141 364 143 358 143 372 144 384 144 387 145
[378] 365 146 352 146 373 146 503 147 367 147 383 148 363
[391] 148 503 150 514 151 374 151 394 151 395 151 501 152
[404] 385 153 388 153 396 153 511 155 503 155 512 156 346
[417] 156 395 156 512 157 505 158 396 159 501 160 366 160
[430] 382 160 507 161 396 162 397 163 400 164 395 165 511
[443] 166 362 167 391 167 526 167 536 168 388 168 397 168
[456] 561 170 386 170 390 171 397 171 529 172 511 173 381
[469] 175 536 175 541 177 503 177 542 178 397 178 526 178
[482] 529 179 532 179 533 185 518 185 565 189 381 190 510
[495] 190 514 191 526 192 389 193 390 194 541 195 534 195
[508] 552 196 393 196 516 199 385 199 548 200 530 200 554
[521] 202 384 202 534 202 539 204 529 205 553 206 536 206
[534] 547 206 554 208 555 208 568 209 568 210 533 210 533
[547] 210 555 212 557 213 532 216 557 217 539 217 558 218
[560] 533 219 550 222 546 222 554 223 564 224 552 225 524
[573] 225 557 226 540 228 562 230 547 231 554 231 560 233
[586] 557 234 551 235 547 235 553 237 558 241 518 243 564
[599] 249 559 251 541 266 567
> checkorder(f2$position)
[1] TRUE
> f3 <- readSAM(sprintf("%s/%s", fileDir, "single.bam"))
> f4 <- readSAM(sprintf("%s/%s", fileDir, "paired.bam"))
> all(f4$position == f2$position)
[1] TRUE
> f5 <- readSAM(sprintf("%s/%s", fileDir, "single-sorted.bam"))
> f6 <- readSAM(sprintf("%s/%s", fileDir, "paired-sorted.bam"))
> all(f6$position == f2$position)
[1] TRUE
> 
> r1 <- readSAM(sprintf("%s/%s", fileDir, "single-sorted.bam"),
+               "seq1:200-400")
> range(r1$position)
[1] 168 399
> 
> r2 <- readSAM(sprintf("%s/%s", fileDir, "paired-sorted.bam"),
+               "seq1:200-400")
> range(r2$position)
[1] 168 400
> r2$pairpos
  [1]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [14]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [27]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [40]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [53]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [66]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [79]   0   0   0   0   0   0   0   0   0   0   0   0   0
 [92]   0   0   0   0   0   0   0   0   0   0   0   0   0
[105]   0   0   0   0   0   0   0   0   0   0   0   0   0
[118]   0   0   0   0   0   0   0   0   0   0   0   0   0
[131]   0   0   0   0   0   0   0   0   0   0   0   0   0
[144]   0   0   0   0   0   0   0   0   0   0   0   0   0
[157]   0   0   0   0   0   0   0   0   0   0   0   0   0
[170]   0   0   0   0   0   0   0   0   0   0   0   0   0
[183]   0   0   0   0   0   0   0   0   0   0   0   0   0
[196]   0   0   0   0   0   0   0   0   0   0   0   0   0
[209]   0   0 388 168 397 168   0 386 170 390 170 397 171
[222]   0   0 381 173   0   0   0   0 397 178   0   0   0
[235]   0   0   0 381 189   0   0   0 389 192 390 193   0
[248]   0   0 393 196   0 385 199   0   0   0 384 202   0
[261]   0   0   0   0   0   0   0   0   0   0   0   0   0
[274]   0   0   0   0   0   0   0   0   0   0   0   0   0
[287]   0   0   0   0   0   0   0   0   0   0   0   0   0
[300]   0
> 
> 
